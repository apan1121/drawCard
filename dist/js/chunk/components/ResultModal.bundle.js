"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[33],{2163:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});var a=o(3967),l={id:"ResultBox",ref:"box",class:"modal",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false"},n={class:"modal-dialog",role:"document"},r={class:"modal-content"},i={class:"modal-header"},d={class:"modal-title"},s=(0,a.createElementVNode)("i",{class:"fas fa-poll"},null,-1),c=(0,a.createElementVNode)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,a.createElementVNode)("span",{"aria-hidden":"true"},"×")],-1),m={ref:"body",class:"modal-body",style:{"max-height":"calc(100vh - 200px)",overflow:"auto","min-height":"400px"}},u={class:"card-list-page"},p={class:"table"},b=(0,a.createElementVNode)("thead",null,[(0,a.createElementVNode)("tr",null,[(0,a.createElementVNode)("th",{style:{width:"20%"}}," 卡片 "),(0,a.createElementVNode)("th",{style:{width:"30%"}}," 名稱 "),(0,a.createElementVNode)("th",null,"獎項")])],-1),f={style:{width:"20%"}},h={style:{width:"30%"}},g=(0,a.createElementVNode)("hr",null,null,-1),v={class:"modal-footer"},w=(0,a.createElementVNode)("div",{class:"col-6 text-left"},null,-1),y={class:"col-6 text-right"},N={ref:"download",class:"modal result-modal",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false"},E={class:"modal-dialog modal-lg",role:"document"},V={class:"modal-content"},x={class:"modal-body"},O=(0,a.createElementVNode)("p",{class:"text-center mb-3",style:{"font-size":"50px"}},[(0,a.createElementVNode)("i",{class:"fa-spin fas fa-sync"})],-1),k={class:"text-center",style:{"font-size":"30px"}};var D=o(2678),R=(o(6247),o(988)),S=o(6300);function C(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function P(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?C(Object(o),!0).forEach((function(t){L(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):C(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function L(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const z={components:{GoogleSupport:(0,a.defineAsyncComponent)((()=>o.e(703).then(o.bind(o,9252)))),CardInfoBox:(0,a.defineAsyncComponent)((()=>o.e(455).then(o.bind(o,4315))))},filters:{},props:{},data:()=>({langPaths:["common","ResultList"],isDownload:!1,showGooglSupport:!1}),computed:P(P({},(0,D.mapGetters)({config:"config",triggerOpenResult:"triggerOpenResult",prizeCardMapping:"prizeCardMapping",validCardList:"validCardList",validPrizeList:"validPrizeList"})),{},{cardListWithPrize(){var e=this,t=[],o=JSON.parse(JSON.stringify(e.validPrizeList)),a=JSON.parse(JSON.stringify(e.prizeCardMapping)),l=JSON.parse(JSON.stringify(e.validCardList)),n={};o.forEach((e=>{n[e.sn]=e}));var r={},i=function(e){a[e].forEach((t=>{n[e]&&(void 0===r[t]&&(r[t]=[]),r[t].push(n[e].title))}))};for(var d in a)i(d);return l.forEach((e=>{e.prize=[],r[e.sn]&&(e.prize=r[e.sn]),t.push(e)})),t}}),watch:{triggerOpenResult:{immediate:!0,handler(){this.$nextTick((()=>{this.triggerOpenResult?S(this.$refs.box).modal("show"):S(this.$refs.box).modal("hide")}))}}},beforeCreate(){},created(){},mounted(){var e=this;e.box=S(e.$refs.box),e.box.bind("shown.bs.modal",(()=>{R.XD.mixpanel("ResultOpen_click"),R.XD.gtag("event","ResultOpen_click")})),e.box.bind("hidden.bs.modal",(()=>{e.isDownload||(e.triggerModal({key:"Result",close:!0}),R.XD.mixpanel("ResultClose_click"),R.XD.gtag("event","ResultClose_click"))})),e.downloadBox=S(e.$refs.download),e.downloadBox.bind("shown.bs.modal",(()=>{e.showGooglSupport=!0})),e.downloadBox.bind("hidden.bs.modal",(()=>{e.showGooglSupport=!1}))},updated(){},beforeUnmount(){S(this.$refs.box).modal("hide")},unmounted(){},methods:P(P(P({},(0,D.mapActions)({})),(0,D.mapMutations)({triggerModal:"triggerModal"})),{},{downloadResult(){var e=this;e.isDownload=!0,e.box.modal("hide"),e.downloadBox.modal("show"),clearTimeout(e.downloadTimer);var t=R.Z_.randRange(2e3,5e3),o="".concat(this.config.webTitle||"DrawCard"," - ").concat(e.$t("common.Header.ResultList")),a=JSON.parse(JSON.stringify(e.cardListWithPrize)),l="".concat(this.$t("ResultList.DownloadHeaderCardTitle"),",").concat(this.$t("ResultList.DownloadHeaderPrizeList"),"\n");a.forEach((e=>{l+="".concat([e.title,e.prize.join("、")].join(","),"\n")}));var n="data:text/csv;charset=utf-8,".concat(l),r=encodeURI(n),i=document.createElement("a");i.style.display="none",i.setAttribute("href",r),i.setAttribute("download","".concat(o,".csv")),document.body.appendChild(i),e.downloadTimer=setTimeout((()=>{i.click(),e.box.modal("show"),e.downloadBox.modal("hide"),e.isDownload=!0,R.XD.mixpanel("ResultDownload_click",{csv:l}),R.XD.gtag("event","ResultDownload_click")}),t)}})};const j=(0,o(4407).Z)(z,[["render",function(e,t,o,D,R,S){var C=(0,a.resolveComponent)("card-info-box"),P=(0,a.resolveComponent)("google-support");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createElementVNode)("div",l,[(0,a.createElementVNode)("div",n,[(0,a.createElementVNode)("div",r,[(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("h5",d,[s,(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.$t("common.Header.ResultList")),1)]),c]),(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",u,[(0,a.createElementVNode)("table",p,[b,(0,a.createElementVNode)("tbody",null,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(S.cardListWithPrize,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("tr",{key:e.sn},[(0,a.createElementVNode)("td",f,[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(C,{"card-info":e,"box-size":100},null,8,["card-info"])])]),(0,a.createElementVNode)("td",h,(0,a.toDisplayString)(e.title),1),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(e.prize.join("、")),1)])))),128))])])]),g,(0,a.createVNode)(P)],512),(0,a.createElementVNode)("div",v,[w,(0,a.createElementVNode)("div",y,[(0,a.createElementVNode)("button",{type:"button",class:"btn btn-primary download-btn",onClick:t[0]||(t[0]=function(){return S.downloadResult&&S.downloadResult(...arguments)})},(0,a.toDisplayString)(e.$t("ResultList.DownloadPrizeList")),1)])])])])],512),(0,a.createElementVNode)("div",N,[(0,a.createElementVNode)("div",E,[(0,a.createElementVNode)("div",V,[(0,a.createElementVNode)("div",x,[O,(0,a.createElementVNode)("h5",k,(0,a.toDisplayString)(e.$t("ResultList.DownloadProcessing")),1),R.showGooglSupport?((0,a.openBlock)(),(0,a.createBlock)(P,{key:0})):(0,a.createCommentVNode)("",!0)])])])],512)])}]])}}]);